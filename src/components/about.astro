---
import { Icon } from "astro-icon";
import { Image } from "@astrojs/image/components";
import ContentSection from "@components/content-section.astro";
import { PersonItem } from "~/types";
import data from "@data/about.yaml";

const MemberData: Array<PersonItem> = data.people;
const images = await import.meta.glob("../../assets/headshots/*");
const people = await Promise.all(
  MemberData.map(async (m) => {
    const im = Object.entries(images).find(([file, load]) =>
      file.endsWith(m.picture)
    );
    m.resolvedImage = ((await im![1]()) as any)["default"];
    return m;
  })
);
---

<ContentSection title={data.title} subtitle={data.subtitle} id="about">
  <Fragment slot="desc">{data.body}</Fragment>
  <ul class="flex max-w-6xl flex-col gap-4 sm:flex-row sm:gap-8 mt-4">
    {
      people.map(({ name, bio, picture, resolvedImage }) => (
        <div>
          <Image
            class="headshot m-auto"
            width={200}
            aspectRatio="1:1"
            position="entropy"
            formats={["webp", "avif"]}
            src={resolvedImage}
            alt={"Picture of " + name}
          />
          <p class="text-center font-bold">{name}</p>
          <p class="whitespace-pre-line text-center text-offset text-sm">{bio}</p>
        </div>
      ))
    }
  </ul>
</ContentSection>

<style>
  .headshot {
    clip-path: circle();
  }
</style>
